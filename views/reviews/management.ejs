<% if (title) { %>
  <h1><%= title %></h1>
<% } else {res.redirect('/')} %>

<%- messages() %>

<div class="review-management">
  <% if (reviews && reviews.length > 0) { %>
    <table>
      <thead>
        <tr>
          <th>Vehicle</th>
          <th>Customer</th>
          <th>Rating</th>
          <th>Title</th>
          <th>Date</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% reviews.forEach(review => { %>
          <tr>
            <td><%= review.inv_make %> <%= review.inv_model %></td>
            <td><%= review.account_firstname %> <%= review.account_lastname %></td>
            <td>
              <% for(let i = 1; i <= 5; i++) { %>
                <%= i <= review.review_rating ? '⭐' : '☆' %>
              <% } %>
            </td>
            <td><%= review.review_title %></td>
            <td><%= new Date(review.review_date).toLocaleDateString() %></td>
            <td><%= review.review_approved ? 'Approved' : 'Pending' %></td>
            <td>
              <% if (!review.review_approved) { %>
                <form action="/reviews/approve/<%= review.review_id %>" method="post" style="display: inline;">
                  <button type="submit">Approve</button>
                </form>
              <% } %>
              <form action="/reviews/delete/<%= review.review_id %>" method="post" style="display: inline;">
                <button type="submit" onclick="return confirm('Are you sure you want to delete this review?')">Delete</button>
              </form>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } else { %>
    <p>No reviews found.</p>
  <% } %>
</div>